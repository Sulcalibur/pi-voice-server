<!doctype html>
<html>
<head>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="PitchDetect.js"></script>
  <style>
    #graphs{
      width: 100%;
    }
    #graphs .graph{
      width: 100%;
      height: 500px;
    }
    #voices {
      width: 100%;
      height: 600px;
    }
  </style>
</head>
<body>
  <button id="start">Start new log</button>
  <button id="stop">Stop logging</button>
  <p>Male voice mean: <span id="d1Mean"></span></p>
  <p>Female voice mean: <span id="d2Mean"></span></p>
  <p>Guess for sample: <span id="d3Mean"></span> : <span id="d3Guess"></span></p>
  <div id="voices"></div>
  <div id="graphs"></div>
</body>
<script type="text/javascript">
  var pd = new PitchDetect();
  var start = document.getElementById("start");
  var stop = document.getElementById("stop");
  start.addEventListener("click", function(){
    pd.startLoggingPitch();
  });
  stop.addEventListener("click", function(){
    pd.stopLoggingPitch();
  });

  var d1 = [4898,149,519,7315,7358,123,700,230,558,580,14701,371,5513,5512,525,817,207,14529,14690,420,147,428,7358,513,479,441,5513,394,5509,14727,479,551,519,432,14694,7347,630,420,538,1026,760,817,4010,416,513,544,14700,496,317,272,256,302,6299,544,513,485,8805,245,2756,320,334,544,401,387,455,11021,501,424,432,437,7348,350,573,649,802,538,14692,496,4008,252,14699,474,211,253,938,513,441,678,723,14660,485,519,11024,474,242,256,256,292,259,240,3676,455,14733,588,639,630,288,531,455,760,221,678,787,4900,4899,469,474,565,565,7395,531,501,441,7373,424,573,294,238,580,580,580,668,246,802,7357,5514,479,639,3392,324,4009,464,565,479,1225,1192,332,588,735,215,630,760,371,220,1002,596,294,320,4898,11028,450,474,788,14694,1002,327,501,2756,223,630,227,4410,201,269,501,459,253,236,238,227,668,3675,3675,630,226,604,14695,551,405,747,700,648,1837,356,14689,14679,455,232,2005,639,760,551,1103,678,4900,412,565,1423,760,2940,215,565,445,596,1521,215,5512,485,513,432,377,227,218,544,588,202,4900,356,2940,531,4410,200,240,416,428,507,361,565,668,7356,469,689,5515,459,558,2005,455,11025,2450,3678,604,711,649,1192,3672,2756,339,324,513,14700,14682,485,788,678,525,464,441,401,464,501,368,4901,7346,5512,507,4410,7366,4009,405,377,531,216,4900,320,469,232,334,14669,678,832,374,7379,7354,14696,604,3150,2321,374,621,359,361,14734,596,8819,405,374,513,3392,240,544,700,322,236,231,408,544,558,700,4009,469,228,544,4902,525,364,5512,14692,401,347,205,723,213,1633,1423,573,531,332,544,14710,2321,405,4901,604,334,7341,525,544,649,639,2205,5513];
  var d2 = [4902,264,281,259,14601,10999,501,788,573,339,658,639,5510,8828,7358,283,588,445,531,2757,2321,621,11029,507,531,432,8805,649,347,689,3150,2940,604,420,2940,334,630,513,1050,7361,7353,2942,3150,7370,408,210,1423,496,441,432,613,519,490,356,735,668,959,437,420,7352,580,588,455,4014,531,14695,501,848,383,711,2940,3675,621,832,639,658,501,802,513,3676,4411,445,339,689,588,7344,428,689,7368,802,356,817,7358,14707,573,2594,865,7388,613,689,7355,735,848,14701,604,5520,551,249,237,420,445,580,261,2940,262,573,3398,469,613,865,760,531,7351,474,4009,3675,802,353,7365,7353,490,496,496,668,7313,490,408,474,2940,394,7348,658,374,3677,882,288,186,2940,441,455,237,565,296,612,538,253,538,14684,630,6318,464,221,215,774,760,2005,428,14705,538,253,919,525,14726,4013,412,420,588,621,689,538,345,580,401,865,474,531,2941,919,8821,11057,401,580,459,580,6301,848,531,1838,4008,380,8820,774,185,7350,408,347,678,455,689,760,412,8808,580,525,469,496,11023,3153,496,4008,760,748,735,2321,256,573,7360,565,787,919,919,525,281,573,538,580,7354,8765,1026,4899,4410,490,259,464,464,5524,380,668,445,428,519,496,339,8805,747,2004,8796,8820,450,420,496,387,700,882,501,479,324,4407,216,4899,5512,5513,3150,700,450,226,14724,479,195,544,437,1026,464,428,210,8819,558,1026,7351,401,416,455,6300,190,802,774,8820,361,760,450,420,519,490,573,496,723,390,4900,332];
  var start = 0;
  window.HighPoint = 1000;
  var size = 100;
  
  window.d1Mean = 0;

  var i, val, avg, count;
  avg = 0;
  count = 0;
  for(i=0; i<d1.length; i++){
    val = d1[i];
    if(val > 0 && val < HighPoint){
      avg += val;
      count++;
    }
  }
  avg = (avg / count).toFixed(1);

  d1Mean = avg;
  document.getElementById("d1Mean").textContent = d1Mean

  window.d2Mean = 0;

  avg = 0;
  count = 0;
  for(i=0; i<d2.length; i++){
    val = d2[i];
    if(val > 0 && val < HighPoint){
      avg += val;
      count++;
    }
  }
  avg = (avg / count).toFixed(1);

  d2Mean = avg;
  document.getElementById("d2Mean").textContent = d2Mean

  var data = [
    {
      x: d1,
      opacity: 0.75,
      type: "histogram",
      autobinx: false,
      name: "Male",
      xbins: {
        start: start,
        end: HighPoint,
        size: size
      }
    },
    {
      x: d2,
      opacity: 0.75,
      type: "histogram",
      autobinx: false,
      name: "Female",
      xbins: {
        start: start,
        end: HighPoint,
        size: size
      }
    }
  ]
  Plotly.newPlot(document.getElementById("voices"), data)
</script>
</html>  